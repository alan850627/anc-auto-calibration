(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15784,        432]
NotebookOptionsPosition[     14873,        396]
NotebookOutlinePosition[     15397,        417]
CellTagsIndexPosition[     15354,        414]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "Ra1", ",", " ", "Ra2", ",", " ", "Rb1", ",", " ", "Rb2", ",", " ", "Rc1", 
   ",", " ", "Rc2", ",", " ", "k", ",", " ", "c", ",", "pointA", ",", " ", 
   "pointB", ",", " ", "pointC", ",", " ", "point1", ",", "point2", ",", "A", 
   ",", "B", ",", "P1", ",", "P2", ",", "mat", ",", "noise", ",", "sol", ",", 
   "p"}], "]"}]], "Input",
 CellChangeTimes->{{3.717950747272747*^9, 3.7179507591699743`*^9}, {
  3.717951733777711*^9, 3.717951734024646*^9}, {3.71795208318711*^9, 
  3.717952121026471*^9}, {3.7179521660085244`*^9, 3.717952187080313*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"pointA", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"pointB", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"pointC", "=", 
     RowBox[{"{", 
      RowBox[{"20", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"point1", "=", 
     RowBox[{"{", 
      RowBox[{"5", ",", 
       RowBox[{"-", ".1"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"point2", "=", 
     RowBox[{"{", 
      RowBox[{"5", ",", ".1"}], "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Ra1", "=", "0.401"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ra2", "=", "0.50"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rb1", "=", "0.485"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rb2", "=", "0.395"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rc1", "=", "1.130"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rc2", "=", "1.130"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f", "=", "800"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"k", "=", 
     RowBox[{"2", "Pi", " ", 
      RowBox[{"f", "/", "343"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mat", " ", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", "Ra1"}], "*", " ", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "I"}], " ", "k", " ", "Ra1"}], ")"}]}]}], ",", " ", 
         RowBox[{
          RowBox[{"1", "/", "Rb1"}], "*", " ", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "I"}], " ", "k", " ", "Rb1"}], ")"}]}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", "Ra2"}], " ", "*", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "I"}], " ", "k", " ", "Ra2"}], ")"}]}]}], ",", " ", 
         RowBox[{
          RowBox[{"1", "/", "Rb2"}], " ", "*", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "I"}], " ", "k", " ", "Rb2"}], ")"}]}]}]}], "}"}]}],
       "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"noise", "=", 
     RowBox[{"c", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "Rc1"}], " ", "*", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "I"}], " ", "k", " ", "Rc1"}], ")"}]}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "Rc2"}], "*", " ", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "I"}], " ", "k", " ", "Rc2"}], ")"}]}]}], "}"}]}], 
       "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol", "=", 
     RowBox[{"-", " ", 
      RowBox[{
       RowBox[{"Inverse", "[", "mat", "]"}], ".", "noise"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{
      RowBox[{"mat", ".", "sol"}], "+", "noise"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"A", "=", 
    RowBox[{"AbsArg", "[", 
     RowBox[{"Part", "[", 
      RowBox[{"sol", ",", "1", ",", "1"}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"B", "=", 
    RowBox[{"AbsArg", "[", 
     RowBox[{"Part", "[", 
      RowBox[{"sol", ",", "2", ",", "1"}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"pfunc", "[", 
       RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"A", "/", 
         RowBox[{"(", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"pointA", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "-", "x"}], ")"}], "^", "2"}],
             "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"pointA", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", "y"}], ")"}], "^", 
             "2"}]}], "]"}], ")"}]}], "*", 
        RowBox[{"E", "^", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "I"}], " ", "k", " ", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"pointA", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", "x"}], ")"}], "^", 
              "2"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"pointA", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", "y"}], ")"}], "^", 
              "2"}]}], "]"}]}], ")"}]}]}], "+", 
       RowBox[{
        RowBox[{"B", "/", 
         RowBox[{"(", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"pointB", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "-", "x"}], ")"}], "^", "2"}],
             "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"pointB", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", "y"}], ")"}], "^", 
             "2"}]}], "]"}], ")"}]}], "*", 
        RowBox[{"E", "^", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "I"}], " ", "k", " ", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"pointB", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", "x"}], ")"}], "^", 
              "2"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"pointB", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", "y"}], ")"}], "^", 
              "2"}]}], "]"}]}], ")"}]}]}], "+", 
       RowBox[{
        RowBox[{"c", "/", 
         RowBox[{"(", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"pointC", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "-", "x"}], ")"}], "^", "2"}],
             "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"pointC", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", "y"}], ")"}], "^", 
             "2"}]}], "]"}], ")"}]}], "*", 
        RowBox[{"E", "^", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "I"}], " ", "k", " ", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"pointC", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", "x"}], ")"}], "^", 
              "2"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"pointC", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", "y"}], ")"}], "^", 
              "2"}]}], "]"}]}], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pdb", "[", "x_", "]"}], ":=", 
      RowBox[{"20", " ", 
       RowBox[{"Log10", "[", 
        RowBox[{"x", "/", 
         RowBox[{"(", 
          RowBox[{"20", "*", 
           RowBox[{"10", "^", 
            RowBox[{"-", "6"}]}]}], ")"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Plot3D", "[", 
      RowBox[{
       RowBox[{"pdb", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"N", "[", 
          RowBox[{"pfunc", "[", 
           RowBox[{"x", ",", "y"}], "]"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "20"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"-", "10"}], ",", " ", "10"}], "}"}]}], "]"}]}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.7179497037292004`*^9, 3.7179497197677937`*^9}, {
   3.717949751811816*^9, 3.717949819212353*^9}, {3.717949899607802*^9, 
   3.717949955336684*^9}, {3.7179503447688513`*^9, 3.717950364818085*^9}, {
   3.7179503949986196`*^9, 3.717950395083259*^9}, {3.7179504566631126`*^9, 
   3.7179505751050825`*^9}, {3.7179508691052275`*^9, 3.717950885546204*^9}, 
   3.717951142900011*^9, {3.7179513935307255`*^9, 3.7179514011886487`*^9}, {
   3.71795144090714*^9, 3.7179514614993877`*^9}, {3.717951517959405*^9, 
   3.71795154383298*^9}, {3.7179519077169065`*^9, 3.7179520721238265`*^9}, 
   3.717952142889952*^9, {3.7179522081514215`*^9, 3.717952232605174*^9}, {
   3.7179522626399174`*^9, 3.717952270975134*^9}, {3.7179523124707365`*^9, 
   3.717952316517542*^9}, {3.7179523715782633`*^9, 3.7179523855619087`*^9}, {
   3.7179524332234*^9, 3.7179524436667013`*^9}, {3.7179525254330564`*^9, 
   3.717952618905616*^9}, {3.71795266787368*^9, 3.717952809712561*^9}, {
   3.717953004168507*^9, 3.7179530045537376`*^9}, {3.717953100461413*^9, 
   3.717953100661264*^9}, {3.717953256810817*^9, 3.717953280618579*^9}, {
   3.7179534363419695`*^9, 3.7179534692756786`*^9}, 3.7179536027970715`*^9, {
   3.7179542382090816`*^9, 3.7179543134262104`*^9}, {3.7179545001609354`*^9, 
   3.717954500407673*^9}, {3.7179546530205483`*^9, 3.7179546588343334`*^9}, {
   3.717954749304212*^9, 3.7179547510719995`*^9}, {3.7179548124940586`*^9, 
   3.717954812693882*^9}, {3.717954911067844*^9, 3.7179549155142355`*^9}, {
   3.7179549983440175`*^9, 3.7179549996743155`*^9}, {3.7179550784777107`*^9, 
   3.717955109024429*^9}, {3.7179551861515226`*^9, 3.7179551880347824`*^9}, {
   3.717955261143671*^9, 3.7179552631828165`*^9}, {3.717955306363701*^9, 
   3.7179553077323837`*^9}, {3.717955341994644*^9, 3.7179553446781893`*^9}, {
   3.7179557178683076`*^9, 3.7179557908459425`*^9}, 3.717955868772704*^9, {
   3.7179560525883775`*^9, 3.7179560624461327`*^9}, {3.717956096920001*^9, 
   3.7179561202201014`*^9}, 3.7179564638091917`*^9, {3.7179566117304664`*^9, 
   3.7179566119884143`*^9}, {3.7180382028926625`*^9, 3.718038208226299*^9}, {
   3.7180385803895764`*^9, 3.718038580720709*^9}, {3.718038650857354*^9, 
   3.7180386849173193`*^9}, {3.718038798390256*^9, 3.7180388066520863`*^9}, {
   3.7180389332810717`*^9, 3.718038935262294*^9}, {3.718039031989506*^9, 
   3.7180390338734174`*^9}, {3.7180390960209813`*^9, 3.71803909623672*^9}, {
   3.7180393371095943`*^9, 3.718039339339536*^9}, {3.7180400661969037`*^9, 
   3.7180400958803644`*^9}, {3.7185500585185785`*^9, 
   3.7185500601593213`*^9}, {3.7185506974665375`*^9, 3.718550697966563*^9}, {
   3.7186295127025304`*^9, 3.718629513003508*^9}, {3.719250520140848*^9, 
   3.719250546033719*^9}, {3.731078287997426*^9, 3.73107830944236*^9}, {
   3.731682530303864*^9, 3.7316825700579453`*^9}, {3.7316826496103115`*^9, 
   3.731682717660821*^9}, {3.7318526553309116`*^9, 3.731852669164959*^9}, {
   3.7318530348557625`*^9, 3.731853083865451*^9}, {3.731853648215687*^9, 
   3.731853675498722*^9}, {3.7318543080409665`*^9, 3.731854323566655*^9}, {
   3.731855617975581*^9, 3.731855618206651*^9}, {3.7318565641579885`*^9, 
   3.731856575677615*^9}, {3.7318566173025913`*^9, 3.73185668463973*^9}, {
   3.731856752079668*^9, 3.7318567819433126`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.2447304523117321`", ",", 
   RowBox[{"-", "0.6247874734290221`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.731852669739132*^9, {3.7318530917965956`*^9, 3.731853105562481*^9}, {
   3.7318536697382245`*^9, 3.7318536917243433`*^9}, 3.731853721872157*^9, 
   3.731854331705278*^9, {3.7318556190145035`*^9, 3.7318556237266135`*^9}, {
   3.7318567320361967`*^9, 3.731856782385393*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.258986669649835`", ",", 
   RowBox[{"-", "0.7707871993480984`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.731852669739132*^9, {3.7318530917965956`*^9, 3.731853105562481*^9}, {
   3.7318536697382245`*^9, 3.7318536917243433`*^9}, 3.731853721872157*^9, 
   3.731854331705278*^9, {3.7318556190145035`*^9, 3.7318556237266135`*^9}, {
   3.7318567320361967`*^9, 3.7318567823888836`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"N", "[", 
   RowBox[{
    RowBox[{"-", "2059"}], " ", "*", " ", "2", 
    RowBox[{"Pi", "/", 
     RowBox[{"(", "1024", ")"}]}]}], "]"}], "+", 
  RowBox[{"2", "*", "2", "Pi"}]}]], "Input",
 CellChangeTimes->{{3.7318584459662943`*^9, 3.7318584954439683`*^9}, {
  3.7318589451539497`*^9, 3.7318589539591103`*^9}, {3.7318599717118745`*^9, 
  3.7318599718548355`*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.0674951546669682`"}]], "Output",
 CellChangeTimes->{3.731858954543785*^9, 3.7318599721839037`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"6.350680461846554`", "/", 
  RowBox[{"(", 
   RowBox[{"2", "Pi", "*", "1000"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.73185889926834*^9, 3.731858903525611*^9}, 
   3.73185896269425*^9}],

Cell[BoxData["0.0010107421875000001`"], "Output",
 CellChangeTimes->{3.7318589083645983`*^9, 3.7318589632159147`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"0.0674951546669682`", "/", 
  RowBox[{"(", 
   RowBox[{"2", "Pi", " ", "*", "1000"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.731859979726019*^9, 3.731859984827796*^9}}],

Cell[BoxData["0.0000107421875`"], "Output",
 CellChangeTimes->{3.7318599851533933`*^9}]
}, Open  ]]
},
WindowSize->{1280, 677},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{612, 792}},
Magnification:>1.3 Inherited,
FrontEndVersion->"10.1 for Microsoft Windows (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 600, 10, 65, "Input"],
Cell[CellGroupData[{
Cell[1183, 34, 11559, 295, 665, "Input"],
Cell[12745, 331, 425, 8, 39, "Output"],
Cell[13173, 341, 426, 8, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13636, 354, 399, 10, 39, "Input"],
Cell[14038, 366, 129, 2, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14204, 373, 212, 5, 39, "Input"],
Cell[14419, 380, 117, 1, 72, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14573, 386, 194, 4, 39, "Input"],
Cell[14770, 392, 87, 1, 39, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
